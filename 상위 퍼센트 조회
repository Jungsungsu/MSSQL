-- 카드 타입이 Vista인 데이터 상위 1% 조회
SELECT TOP(SELECT COUNT(*)/100 FROM Sales.CreditCard) CreditCardID -- 상위 1% 조회
FROM Sales.CreditCard
WHERE CardType = 'Vista'
ORDER BY ExpYear, ExpMonth;

-- 카드 타입이 Vista인 데이터 상위 0.1% 조회
SELECT TOP(0.1) PERCENT CreditCardID, ExpYear, ExpMonth -- 상위 0.1% 조회
FROM Sales.CreditCard
WHERE CardType = 'Vista'
ORDER BY ExpYear, ExpMonth;

-- 상위 0.1%를 출력하되 마지막이랑 같으면 다 출력
SELECT TOP(0.1) PERCENT WITH TIES CreditCardID, ExpYear, ExpMonth -- 상위 0.1%이면서 마지막이랑 같으면 다 출력
FROM Sales.CreditCard
WHERE CardType = 'Vista'
ORDER BY ExpYear, ExpMonth;
